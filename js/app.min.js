APP_DATA={};APP_DATA.posts=[{title:"如何在ruby中轉換integer與bit string",datetime:"2014-02-20 09:52:39",tag:["ruby"],category:["programming"],link:"ruby-how-to-convert-integer-to-bit-string",file:"2014-02-20-095239-ruby-how-to-convert-integer-to-bit-string",template:["post"]},{title:"dup與clone的差異",datetime:"2014-02-20 10:08:54",tag:["ruby"],category:["programming"],template:["post"],link:"ruby-compare-dup-and-clone",file:"2014-02-20-100854-ruby-compare-dup-and-clone"},{title:"ruby class的initialize",datetime:"2014-02-22 11:28:58",tag:["ruby"],category:["programming"],link:"ruby-class-initialize",file:"2014-02-22-112858-ruby-class-initialize",template:["post"]},{title:"如何在rails的controller中做到before_render",datetime:"2014-02-23 13:00:36",tag:["rails_controller"],category:["programming"],link:"rails-how-to-before-render",file:"2014-02-23-130036-rails-how-to-before-render",template:["post"]},{title:"如何顯示utf8的欄位",tag:["mysql"],category:["tools"],datetime:"2014-03-04 13:10:15",template:["post"],link:"mysql-utf8-display",file:"2014-03-04-131015-mysql-utf8-display"},{title:"ruby在if中的assignment",datetime:"2014-03-25 12:28:57",tag:["ruby"],category:["programming"],link:"ruby-if-assignment",file:"2014-03-25-122857-ruby-if-assignment",template:["post"]},{title:"ruby module的用法",datetime:"2014-05-04 08:17:14",tag:["ruby"],category:["programming"],link:"ruby-module",file:"2014-05-04-081714-ruby-module",template:["post"]},{title:"測量mysql query的效能",category:["programming"],tag:["mysql"],datetime:"2014-08-05 12:45:32",template:["post"],link:"mysql-profiling-query",file:"2014-08-05-124532-mysql-profiling-query"},{title:"如何轉換時間字串",category:["programming"],tag:["ruby"],datetime:"2014-09-18 09:48:05",template:["post"],link:"ruby-how-to-parse-time-string",file:"2014-09-18-094805-ruby-how-to-parse-time-string"},{title:"vim在使用自動補齊的時候會爆",category:["tools"],tag:["vim"],datetime:"2014-09-18 11:58:02",template:["post"],link:"vim-dot-auto-complete-crash",file:"2014-09-18-115802-vim-dot-auto-complete-crash"},{title:"oh-my-zsh一些實用小技巧",datetime:"2014-09-28 09:48:56",tag:["zsh"],category:["tools"],template:["post"],link:"oh-my-zsh-tips",file:"2014-09-28-094856-oh-my-zsh-tips"}];APP_DATA.tags={ruby:{name:"ruby",count:6},rails_controller:{name:"rails_controller",count:1},rails:{name:"rails",count:0},mysql:{name:"mysql",count:2},vim:{name:"vim",count:1},zsh:{name:"zsh",count:1}};APP_DATA.categories={programming:{name:"programming",count:8},tools:{name:"tools",count:3}};APP={brand:"魔法師的手帳",author:"Sibevin Wang",footer_trademark:"2014 魔法師的手帳",header_title:"寫程式就像施展魔法一樣"};ROUTES={"/":{template:"layout/home.html",ctrl:"HomeCtrl"},"/tag":{template:"layout/tag_list.html",ctrl:"TagListCtrl"},"/tag/:tag":{template:"layout/tag.html",ctrl:"TagCtrl"},"/post/:year/:month/:day/:link":{template:"layout/post.html",ctrl:"PostCtrl"},"/post":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:keyword":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:year/:month":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:year/:month/:day":{template:"layout/post_list.html",ctrl:"PostListCtrl"}};ROUTES={"/":{template:"layout/home.html",ctrl:"HomeCtrl"},"/tag":{template:"layout/tag_list.html",ctrl:"TagListCtrl"},"/tag/:tag":{template:"layout/tag.html",ctrl:"TagCtrl"},"/post/:year/:month/:day/:link":{template:"layout/post.html",ctrl:"PostCtrl"},"/post":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:keyword":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:year/:month":{template:"layout/post_list.html",ctrl:"PostListCtrl"},"/post/:year/:month/:day":{template:"layout/post_list.html",ctrl:"PostListCtrl"}};(function(){var a;a=angular.module("scsBlogApp",["ngRoute","hljs"]);a.config(["$routeProvider",function(d){var e,c,b;b=[];for(e in ROUTES){c=ROUTES[e];if(c.ctrl){b.push(d.when(e,{controller:c.ctrl,templateUrl:"./"+c.template}))}else{b.push(d.when(e,{templateUrl:"./"+c.template}))}}return b}]);angular.element(document).ready(function(){return angular.bootstrap(document,["scsBlogApp"])})}).call(this);(function(){angular.module("scsBlogApp").controller("FilterPanelCtrl",["$scope","$filter",function(b,e){var f,a,d,c;b.onCfAllChange=function(){var i,k,h,j,g;b.fp_data.ca=[];b.ca_filter_all=true;j=b.categories;g=[];for(k=0,h=j.length;k<h;k++){i=j[k];g.push(b.ca_filter[i.name]=false)}return g};b.onCfChange=function(){b.fp_data.ca=_.keys(_.omit(b.ca_filter,function(g){return g===false}));if(b.fp_data.ca.length>0){return b.ca_filter_all=false}else{return b.onCfAllChange()}};b.onTfAllChange=function(){var g,k,i,j,h;b.fp_data.tag=[];b.tag_filter_all=true;j=b.tags;h=[];for(k=0,i=j.length;k<i;k++){g=j[k];h.push(b.tag_filter[g.name]=false)}return h};b.onTfChange=function(){b.fp_data.tag=_.keys(_.omit(b.tag_filter,function(g){return g===false}));if(b.fp_data.tag.length>0){return b.tag_filter_all=false}else{return b.onTfAllChange()}};a=function(){b.ca_filter={};b.tag_filter={};b.fp_data.ca=[];return b.fp_data.tag=[]};c=function(){return b.tags=_.values(APP_DATA.tags)};d=function(){return b.categories=_.values(APP_DATA.categories)};f=function(){a();c();d();b.onCfAllChange();return b.onTfAllChange()};return f()}])}).call(this);(function(){angular.module("scsBlogApp").controller("HomeCtrl",["$scope","$filter",function(b,f){var g,a,e,c,d;a=function(){};c=function(){return b.posts=APP_DATA.posts};d=function(){return b.tags=APP_DATA.tags};e=function(){return b.categories=APP_DATA.categories};g=function(){b.$parent.updateHeaderTitle(APP.header_title);a();c();d();return e()};return g()}])}).call(this);(function(){angular.module("scsBlogApp").controller("PostCtrl",["$scope","$filter","$routeParams","$location",function(b,d,c,g){var f,a,e;f={title:"",categories:[],tags:[],datetime:"0000-00-00 00:00:00",link:""};a=function(h){return h.file};e=function(){b.enableFilterPanel(false);b.target_post=_.find(APP_DATA.posts,function(h){return h.link===c.link});if(b.target_post){b.$parent.updateHeaderTitle(b.target_post.title);return b.target_html="posts/"+a(b.target_post)+".html"}else{b.$parent.updateHeaderTitle("找不到對應網址的文章…");return b.target_post=f}};return e()}])}).call(this);(function(){angular.module("scsBlogApp").controller("PostListCtrl",["$scope","$filter","$routeParams","$location",function(i,e,h,c){var a,f,j,b,d,g;g=function(k){return k.match(/(\d{4})/)};d=function(k){var l;l=parseInt(k);return l>0&&l<13};b=function(l,k,n){var m;m=new Date(l+"-"+k+"-"+n);if(Object.prototype.toString.call(m)!=="[object Date]"){return false}if(isNaN(m)){return false}else{return true}};f=function(l,m,k){if(m==null){m=1}if(k==null){k=1}l=parseInt(l);m=parseInt(m)-1;return new Date(l,m,k)};a=function(l,m,k){var n;if(m==null){m=null}if(k==null){k=null}if(m===null){l=parseInt(l);m=0;k=1;n=new Date(l+1,m,k)}else{if(k===null){m=parseInt(m)-1;k=1;n=new Date(l,m+1,k)}else{m=parseInt(m)-1;k=parseInt(k);n=new Date(l,m,k+1)}}return new Date(n-1)};j=function(){var o,k,p,l,n,m;i.posts=APP_DATA.posts;i.enableFilterPanel(true);k={};n=[];if(h.keyword){if(g(h.keyword)){l="date";p=h.keyword+"年";k.start_date=f(h.keyword);k.end_date=a(h.keyword);n.push(h.keyword)}else{l="keyword";p='"'+h.keyword+'"';k.keyword=h.keyword}}else{if(h.year){if(g(h.year)){m=h.year;n.push(m);if(h.month&&d(h.month)){o=h.month;n.push(o);if(h.day&&b(m,o,h.day)){l="date";p=m+"∙"+o+"∙"+h.day;k.start_date=f(m,o,h.day);k.end_date=a(m,o,h.day);n.push(h.day)}else{l="date";p=m+"年"+o+"月";k.start_date=f(m,o);k.end_date=a(m,o)}}else{l="date";p=m+"年";k.start_date=f(m);k.end_date=a(m)}}}else{l="all"}}switch(l){case"date":i.posts_in_where="所有"+p+"的文章("+k.start_date+" - "+k.end_date+")";i.$parent.updateHeaderTitle("文章列表 – "+p);i.options=k;return i.title_display=n.join("∙");case"keyword":i.posts_in_where="包含"+p+"標題的所有文章";i.$parent.updateHeaderTitle("文章列表 – 標題包含"+p+"的文章");i.options=k;return i.title_display=p;default:return i.$parent.updateHeaderTitle("文章列表")}};return j()}])}).call(this);(function(){var a=[].indexOf||function(d){for(var c=0,b=this.length;c<b;c++){if(c in this&&this[c]===d){return c}}return -1};angular.module("scsBlogApp").controller("RootCtrl",["$scope","$filter","TabSwitcher",function(c,f,d){var e,g,b;e=function(i){var h;h=i.datetime.match(/(\d{4})-(\d{2})-(\d{2})/);return _.rest(h)};c.showTag=function(h){return h.replace(/_/g," ‣ ")};c.showTagCount=function(h){if(APP_DATA.tags[h]){return APP_DATA.tags[h].count}else{return 0}};c.getDateLink=function(j,k){var i,l,h;i=e(j);l="#/post/";h=(function(){switch(k){case"y":return(_.initial(i,2)).join("/");case"m":return(_.initial(i,1)).join("/");case"d":return i.join("/")}})();return l+h};c.getPostLink=function(i){var h;h=e(i);return"#/post/"+h.join("/")+"/"+i.link};c.getDateValue=function(j,k){var i,h;i=e(j);h=(function(){switch(k){case"y":return i[0];case"m":return i[1];case"d":return i[2]}})();return h};c.updateHeaderTitle=function(h){return c.header_title=h};c.enableFilterPanel=function(h){return c.enable_fp=h};c.showFp=function(){return c.enable_fp&&c.menu_ts.isTab("fp")};c.getFilteredPosts=function(h,j){var i;if(j==null){j=null}i=f("orderBy")(h,"datetime",true);if(c.fp_data.tag.length>0){i=f("filter")(i,function(r){var s,k,t,o,n,q,l,p,m;s=false;p=r.tag;for(o=0,q=p.length;o<q;o++){t=p[o];if(a.call(c.fp_data.tag,t)>=0){s=true;break}m=t.split("_");for(n=0,l=m.length;n<l;n++){k=m[n];if(a.call(c.fp_data.tag,k)>=0){s=true;break}}if(s){break}}return s})}if(c.fp_data.ca.length>0){i=f("filter")(i,function(s){var n,t,q,o,m,r,k,p,l;t=false;p=s.category;for(o=0,r=p.length;o<r;o++){n=p[o];if(a.call(c.fp_data.ca,n)>=0){t=true;break}l=n.split("_");for(m=0,k=l.length;m<k;m++){q=l[m];if(a.call(c.fp_data.ca,q)>=0){t=true;break}}if(t){break}}return t})}if(c.fp_data.keyword!==""){i=f("filter")(i,c.fp_data.keyword)}if(j){if(j.start_date){i=f("filter")(i,function(k){var l;l=new Date(k.datetime);return l>=j.start_date})}if(j.end_date){i=f("filter")(i,function(k){var l;l=new Date(k.datetime);return l<j.end_date})}if(j.keyword){i=f("filter")(i,j.keyword)}}return i};b=function(){c.brand=APP.brand;c.author=APP.author;c.footer_trademark=APP.footer_trademark;c.menu_ts=new d("close");c.enable_fp=true;c.fp_data={};c.fp_data.ca=[];c.fp_data.tag=[];return c.fp_data.keyword=""};g=function(){return b()};return g()}])}).call(this);(function(){var a=[].indexOf||function(d){for(var c=0,b=this.length;c<b;c++){if(c in this&&this[c]===d){return c}}return -1};angular.module("scsBlogApp").controller("TagCtrl",["$scope","$filter","$routeParams","$anchorScroll","$location",function(b,d,c,f,g){var e;b.scrollTo=function(i){var h;h=g.hash();g.hash(i);f();return g.hash(h)};b.getTagList=function(m){var h,j,l,i,k;j=[m];k=_.keys(APP_DATA.tags);for(l=0,i=k.length;l<i;l++){h=k[l];if(h.indexOf(m)>-1){j.push(h)}}return _.uniq(j)};b.getTagPosts=function(h,j){var i;i=d("orderBy")(h,"datetime",true);i=d("filter")(i,function(n){var l,k,p,m,o;l=false;o=n.tag;for(p=0,m=o.length;p<m;p++){k=o[p];if(k===j){l=true;break}}return l});return i};e=function(){var h;b.posts=APP_DATA.posts;b.enableFilterPanel(false);if(c.tag&&(h=c.tag,a.call(_.keys(APP_DATA.tags),h)>=0)){b.target_tag=c.tag;return b.updateHeaderTitle("文章標籤 – "+b.showTag(b.target_tag))}else{return g.path("#/tag")}};return e()}])}).call(this);(function(){angular.module("scsBlogApp").controller("TagListCtrl",["$scope","$filter","$routeParams","$anchorScroll","$location",function(a,c,b,e,f){var d;a.clearQuery=function(){return a.query_keyword=""};a.getFilteredTags=function(){var g;g=c("orderBy")(a.tags);if(a.query_keyword!==""){g=c("filter")(g,a.query_keyword)}return g};d=function(){a.updateHeaderTitle("文章標籤");a.enableFilterPanel(false);a.tags=_.keys(APP_DATA.tags);return a.query_keyword=""};return d()}])}).call(this);(function(){angular.module("scsBlogApp").directive("tagChooser",function(){return{restrict:"EA",replace:true,scope:{tcUid:"@",tcTags:"=",tcModel:"=",tcAllModel:"=",onTcAllChange:"&",onTcChange:"&"},template:'<div class="tag-filter"> <div class="tag-opt"> <input type="checkbox" id="{{tcUid}}_tc_all" name="{{tcUid}}_tag_chooser" value="all" ng-model="tcAllModel" ng-change="onTcAllChange()" /> <label class="tag-label" for="{{tcUid}}_tc_all"> <span class="tag-icon">All</span> </label> </div> <div class="tag-opt" ng-repeat="tag in tcTags | orderBy:\'name\'"> <input type="checkbox" id="{{tcUid}}_tc_{{tag.name}}" name="{{tcUid}}_tag_chooser" value="{{tag.name}}" ng-model="tcModel[tag.name]" ng-change="onTcChange()" /> <label class="tag-label" for="{{tcUid}}_tc_{{tag.name}}"> <span class="tag-icon">{{showTag(tag.name)}}</span> </label> </div> <div class="clearfix" /> </div>',controller:function(c,b,a){return c.showTag=function(d){return d.replace(/_/g," ‣ ")}}}})}).call(this);(function(){var a=[].indexOf||function(d){for(var c=0,b=this.length;c<b;c++){if(c in this&&this[c]===d){return c}}return -1};angular.module("scsBlogApp").factory("TabSwitcher",function(){var b;b=(function(){c.prototype.DEFAULT_TAB="none";c.prototype._init_tab=c.DEFAULT_TAB;c.prototype._current_tab=c.DEFAULT_TAB;c.prototype.reset=function(){return this._current_tab=this._init_tab};c.prototype.getTab=function(){return this._current_tab};c.prototype.setTab=function(d){return this._current_tab=d};c.prototype.isTab=function(d){var e;if(d instanceof Array){return e=this._current_tab,a.call(d,e)>=0}else{return d===this._current_tab}};c.prototype["switch"]=function(d){if(this.isTab(d)){return this.reset()}else{return this.setTab(d)}};function c(d){if(d==null){d=this.DEFAULT_TAB}this._init_tab=d;this.setTab(d)}return c})();return b})}).call(this);